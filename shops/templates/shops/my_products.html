{% extends "layout.html" %}

{% block title %}–ú–æ—ó —Ç–æ–≤–∞—Ä–∏{% endblock %}

{% block header_title %}
    –ú–æ—ó —Ç–æ–≤–∞—Ä–∏
{% endblock %}

{% block users_content %}
{% if products %}
    <div class="row">
        {% for product in products %}
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm h-100">
                    <div class="card-body">
                        <h5 class="card-title">{{ product.title }}</h5>

                        <p class="card-text">
                            <strong>–¶—ñ–Ω–∞:</strong> {{ product.price }} <br>
                            <strong>–ö—ñ–ª—å–∫—ñ—Å—Ç—å:</strong> {{ product.quantity }}
                        </p>

                        <p class="card-text">
                            {{ product.description|truncatechars:100 }}
                        </p>

                        <form method="post" action="{% url 'toggle_product' product.id %}" class="mb-2">
                            {% csrf_token %}

                            {% if product.is_active %}
                                <button type="submit" class="btn btn-success btn-sm w-100">
                                    ‚úÖ –ê–∫—Ç–∏–≤–Ω–∏–π (–Ω–∞—Ç–∏—Å–Ω–∏, —â–æ–± –≤–∏–º–∫–Ω—É—Ç–∏)
                                </button>
                            {% else %}
                                <button type="submit" class="btn btn-secondary btn-sm w-100">
                                    ‚õî –ù–µ–∞–∫—Ç–∏–≤–Ω–∏–π (–Ω–∞—Ç–∏—Å–Ω–∏, —â–æ–± —É–≤—ñ–º–∫–Ω—É—Ç–∏)
                                </button>
                            {% endif %}
                        </form>

                        <button 
                            type="button"
                            class="btn btn-danger btn-sm w-100"
                            data-bs-toggle="modal"
                            data-bs-target="#deleteModal{{ product.id }}">
                            üóë –í–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä
                        </button>
                        <div class="modal fade" id="deleteModal{{ product.id }}" tabindex="-1">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">

                                <div class="modal-header">
                                    <h5 class="modal-title">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>

                                <div class="modal-body">
                                    –í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä:
                                    <strong>{{ product.title }}</strong>?
                                    <br>
                                    –¶—é –¥—ñ—é –Ω–µ–º–æ–∂–ª–∏–≤–æ —Å–∫–∞—Å—É–≤–∞—Ç–∏.
                                </div>

                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                    –°–∫–∞—Å—É–≤–∞—Ç–∏
                                    </button>

                                    <form method="post" action="{% url 'delete_product' product.id %}">
                                    {% csrf_token %}
                                    <button type="submit" class="btn btn-danger">
                                        –¢–∞–∫, –≤–∏–¥–∞–ª–∏—Ç–∏
                                    </button>
                                    </form>
                                </div>

                                </div>
                            </div>
                            </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <p>–£ –≤–∞—Å —â–µ –Ω–µ–º–∞—î —Ç–æ–≤–∞—Ä—ñ–≤</p>
{% endif %}

{% endblock %}

